var e=Object.defineProperty,t=(t,a,s)=>(((t,a,s)=>{a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s})(t,"symbol"!=typeof a?a+"":a,s),s);import{C as a,r as s,c as i,w as l,n,a as o,o as r,b as c,d,e as u,f as h,g as p,h as f,F as m,i as v,j as w,k as g,l as y,t as b,m as k,p as x,q as E,s as C,u as _,v as O,x as M,y as L,z as T,A as D,U as R,Y as B,B as S,S as A,E as z,D as P,G as F,H as U,I as X,J as j,K,L as I,V as N,M as $,N as q,O as W,P as H,Q as V}from"./vendor.68423404.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class G{constructor(){this.port=null,this.reader=null,this.writer=null,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.queue=new a,this.readLoopActive=!1,this.readLoopPromise=null,this.errorLog=[],this.isBusy=!0,this.isConnected=!1,this.isEchoing=!0,this.isTalking=!1,this.mode=">",this.version=null,this.str="",this.output=[]}async connect(){var e,t;try{this.isBusy=!0,this.port=await navigator.serial.requestPort({usbVendorId:7071});try{await this.port.open({baudRate:115200,dataBits:8,parity:"none",stopBits:1,flowControl:"none"})}catch(a){return alert((null==a?void 0:a.message)||"Unable to connect."),void(this.isBusy=!1)}if(this.port.addEventListener("disconnect",(()=>{this.disconnect()})),null==(null==(e=this.port)?void 0:e.writable))return void this.errorLog.push("This is not a writable port.");if(null==(null==(t=this.port)?void 0:t.readable))return void this.errorLog.push("This is not a readable port.");this.reader=this.port.readable.getReader(),this.writer=this.port.writable.getWriter(),this.startReadLoop(),await this.sleep(100),await this.synchronize(),this.isConnected=!0}catch(a){}finally{this.isBusy=!1}}async disconnect(){try{await this.stopReadLoop(),await this.writer.releaseLock(),await this.reader.releaseLock(),await this.port.close()}catch(e){}finally{this.isConnected=!1,this.version=null}}async synchronize(){this.writer.write(this.encoder.encode("")),await this.sleep(100);let e=await this.flush();1===e.length&&(e=e.pop(),">"!==e&&"$"!==e||(this.mode=e)),this.isEchoing&&await this.turnOffEcho();let t=3;for(;t>0;){await this.sleep(100);const e=await this.getVersion();if("string"==typeof e){this.version=e;break}t--}}async getVersion(){const e=await this.write("version()");for(const t of e)if(t.startsWith("v")&&2===(t.match(/\./g)||[]).length)return t}async turnOffEcho(){this.isEchoing&&(await this.write("echo(0)"),this.isEchoing=!1)}sleep(e){return new Promise((t=>setTimeout(t,e)))}startReadLoop(){this.readLoopPromise=this.readLoop()}async stopReadLoop(){this.readLoopActive=!1,this.readLoopPromise&&(await this.reader.cancel(),await this.readLoopPromise,this.readLoopPromise=null)}async readLoop(){let e;for(this.readLoopActive=!0;this.readLoopActive;)try{const{value:t,done:a}=await this.reader.read();if(this.str+=this.decoder.decode(t).replace("\r",""),!this.str)continue;let s=this.str.indexOf("\n");for(s>-1&&this.str.split("\n").forEach((e=>{})),this.isConnected&&(this.output.length&&this.str.startsWith(this.output[this.output.length-1])?this.output[this.output.length-1]=this.str:-1===s&&this.output.push(this.str));s>-1;)e=this.str.substring(0,s),e&&(this.queue.push(e),this.isConnected&&(this.output.length&&this.output[this.output.length-1].startsWith(e)?this.output[this.output.length-1]=e:this.output.push(e))),this.str=this.str.substring(s+1),s=this.str.indexOf("\n");">"!==this.str&&"$"!==this.str&&"&"!==this.str||(this.queue.push(this.str),this.str="",this.output.push("")),a&&(this.readLoopActive=!1)}catch(t){break}}readUntil(e=null){return e||(e=this.mode),new Promise((async t=>{const a=[];let s;do{if(s=await this.queue.pop().catch((()=>{t(a)})),s&&(a.push(s),s.startsWith("!")))break}while(s!==e);a.length>1&&a.pop(),t(a)}))}async flush(){const e=[];let t;do{t=await this.queue.tryPop(),t&&e.push(t)}while(t);return e.length||(this.str=""),e}async escape(){try{this.isBusy=!0,this.queue.cancelWait(new Error("Escape")),await this.write("","")}finally{this.isBusy=!1}}async write(e,t=null,a="\n"){let s=this.isTalking;try{this.isTalking=!0,await this.flush(),this.writer.write(this.encoder.encode(e+a)),">"!==e&&"$"!==e||(this.mode=e),await this.sleep(50);let i=[];return s||(i=t?await this.readUntil(t):await this.readUntil(this.mode)),i}finally{s||(this.isTalking=!1)}}async stream(e){let t=this.encoder.encode(e),a=t.length,s=0;for(;a>0;){const e=t.subarray(s,s+Math.min(64,a));await this.writer.write(e);const i=await this.queue.tryPop();if(i)return this.output.push(i),i;s+=64,a-=e.length,await this.sleep(1)}return null}}const Y=["id"],J=["id"],Q={key:0,class:"ml-2 fas fa-fw fa-external-link"},Z={props:{id:{type:String,required:!0},options:{type:Array,required:!0}},setup(e){const t=e;let a=null,M=null,L=null;const T=s(!1),D=i((()=>({"aria-orientation":!!t.id&&"vertical","aria-labelledby":!!t.id&&`${t.id}-menu`})));return l((()=>T.value),(e=>{n((()=>{e?a=o(L,M,{placement:"bottom-start",modifiers:[{name:"offset",options:{offset:[0,4]}},{name:"preventOverflow",options:{padding:16}}],strategy:"fixed"}):a&&(a.destroy(),a=null)}))})),r((()=>{M=document.getElementById(`menu-${t.id}`),L=document.getElementById(`menu-${t.id}-btn`)})),(t,a)=>{const s=c("click-outside");return d((u(),h("div",null,[p("div",{id:`menu-${e.id}-btn`,class:"inline-flex rounded a",onClick:a[0]||(a[0]=e=>T.value=!T.value)},[f(t.$slots,"default")],8,Y),d(p("div",C(_(D),{id:`menu-${e.id}`,class:"min-w-[100px] border rounded shadow-lg z-10 bg-slate-50 border-slate-300 dark:bg-zinc-700 dark:border-zinc-600",role:"menu"}),[(u(!0),h(m,null,v(e.options,(e=>(u(),w(E((null==e?void 0:e.href)?"a":"div"),{href:(null==e?void 0:e.href)?e.href:void 0,key:e.label,class:"w-full px-4 py-1 text-slate-900 dark:text-zinc-100 hover:bg-slate-200 dark:hover:bg-zinc-600 cursor-pointer",onClick:x((t=>{e.click(),T.value=!1}),["prevent"])},{default:g((()=>[y(b(e.label)+" ",1),(null==e?void 0:e.href)?(u(),h("i",Q)):k("",!0)])),_:2},1032,["href","onClick"])))),128))],16,J),[[O,T.value]])],512)),[[s,()=>T.value=!1]])}}},ee={props:{type:{type:String,default:"primary"}},setup:e=>(t,a)=>(u(),h("button",{class:M(["btn",e.type]),type:"button"},[f(t.$slots,"default")],2))},te={id:"menu-bar",class:"p-2 flex items-center space-x-8"},ae=T('<div class="flex items-center space-x-2"><svg id="logo" class="h-6 w-auto" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 266" preserveAspectRatio="xMidYMid meet" aria-hidden="true"><g transform="translate(0, 266) scale(0.1, -0.1)" fill="currentColor" stroke="none"><path d="M494 2308 c-3 -13 -19 -50 -34 -83 -63 -135 -119 -309 -144 -440 -36 -198 -41 -247 -41 -440 1 -185 6 -247 36 -402 l10 -53 426 0 c468 0 493 3 606 62 115 61 222 210 258 358 8 30 14 105 14 165 0 105 -2 114 -33 177 -37 75 -72 110 -152 147 -50 24 -66 26 -179 26 l-124 0 -22 -110 c-12 -60 -39 -200 -59 -310 -21 -110 -39 -206 -42 -212 -2 -10 -44 -13 -164 -13 l-160 0 6 28 c3 15 10 43 14 62 5 19 21 100 35 180 47 253 73 392 94 499 12 57 21 105 21 106 0 2 18 6 40 10 22 4 52 9 68 11 15 3 113 8 217 11 170 5 201 3 295 -17 266 -56 421 -194 476 -426 23 -97 15 -310 -16 -414 -98 -330 -315 -519 -667 -579 -109 -19 -162 -21 -499 -21 -354 0 -376 -1 -369 -17 4 -10 15 -38 25 -63 10 -25 30 -71 45 -102 l26 -58 2025 0 2024 0 24 48 c69 136 147 377 172 532 9 52 19 113 22 135 9 53 9 449 0 500 -4 22 -12 77 -19 123 l-12 82 -549 0 c-515 0 -548 1 -548 18 0 9 11 69 23 132 l23 115 482 3 c265 1 482 4 482 6 0 11 -32 91 -65 164 l-38 82 -2023 0 -2023 0 -7 -22z m2115 -250 c0 -13 -6 -54 -14 -93 -7 -38 -25 -131 -39 -205 -14 -74 -28 -146 -31 -160 -23 -101 -68 -361 -77 -435 -13 -108 -2 -158 45 -212 41 -47 82 -63 157 -63 102 0 165 40 225 142 43 73 66 153 106 368 42 224 77 410 84 440 3 14 12 63 20 110 9 47 18 95 21 108 4 22 7 22 165 22 148 0 160 -1 156 -17 -3 -10 -9 -36 -13 -58 -4 -22 -8 -44 -9 -50 -2 -5 -14 -73 -29 -150 -14 -77 -28 -151 -31 -165 -3 -14 -17 -83 -30 -155 -77 -414 -106 -504 -211 -651 -62 -88 -145 -145 -267 -185 -89 -30 -298 -38 -387 -15 -188 48 -281 151 -316 351 -20 113 -15 152 76 625 17 91 42 228 56 305 14 77 27 146 29 153 3 9 44 12 160 12 154 0 155 0 154 -22z m1788 -565 c-3 -16 -13 -76 -23 -135 l-18 -108 -255 -2 -256 -3 -11 -60 c-7 -33 -19 -98 -28 -145 -9 -47 -19 -95 -21 -107 l-5 -23 285 0 c268 0 286 -1 281 -17 -3 -10 -12 -61 -21 -113 -8 -52 -18 -105 -20 -118 l-5 -22 -443 2 c-306 2 -441 6 -440 14 1 6 16 84 33 175 17 90 42 223 55 294 13 72 27 141 30 155 3 14 12 63 20 110 9 47 18 95 21 108 l4 22 411 0 412 0 -6 -27z"></path></g></svg><span class="font-bold italic">BETA</span></div>',1),se={class:"flex items-center space-x-4"},ie=p("a",{href:"https://duelink.com",target:"_blank"},"Docs",-1),le=y("Demos"),ne=["data-tippy-content","onClick"],oe={props:{theme:String},emits:["demo","firmware","update:theme","updateTippy"],setup(e,{emit:t}){const a=e,i=s([]);function l(e){"dark"===a.theme?(t("update:theme","light"),localStorage.theme="light",document.documentElement.style.colorScheme="light",document.documentElement.classList.remove("dark")):(t("update:theme","dark"),localStorage.theme="dark",document.documentElement.style.colorScheme="dark",document.documentElement.classList.add("dark")),t("updateTippy",e.target,!0)}return async function(){try{const e=await fetch("/demos.json"),a=await e.json();i.value=a.map((e=>(null==e?void 0:e.url)?{label:e.label,click:()=>window.open(e.url,"_blank"),href:e.url}:{label:e.label,click:()=>t("demo",e.code)}))}catch(e){}}(),(a,s)=>(u(),h("div",te,[ae,p("div",se,[ie,L(Z,{options:i.value,id:"demo"},{default:g((()=>[le])),_:1},8,["options"]),p("a",{onClick:s[0]||(s[0]=x((e=>t("firmware")),["prevent"]))},"Firmware"),p("a",{class:"text-sm","data-tippy-content":"dark"===e.theme?"Light":"Dark",onClick:x(l,["prevent"])},[p("i",{class:M(["dark"===e.theme?"fa-sun":"fa-moon","fas fa-fw pointer-events-none"])},null,2)],8,ne)])]))}},re={id:"tool-bar",class:"p-2 flex items-center space-x-2"},ce=p("i",{class:"fas fa-fw fa-circle"},null,-1),de=p("i",{class:"fas fa-fw fa-play"},null,-1),ue=p("i",{class:"fas fa-fw fa-square"},null,-1),he=p("i",{class:"fas fa-fw fa-list"},null,-1),pe=p("i",{class:"fas fa-fw fa-download"},null,-1),fe={class:"btn primary tool text-center cursor-pointer","data-tippy-content":"Load",for:"file"},me=p("i",{class:"fas fa-fw fa-upload"},null,-1),ve={props:{canDownload:Boolean,canList:Boolean,canLoad:Boolean,canPlay:Boolean,canRecord:Boolean,disabled:Boolean,isConnected:Boolean},emits:["connect","disconnect","download","play","stop","record","list","load"],setup(e,{emit:t}){const a=e;function s(e){if(!e.target.files.length)return;const a=new FileReader;a.onload=function(){t("load",a.result.replace(/\r/gm,"").replace(/\t/gm," ").split("\n")),e.target.value=""},a.readAsText(e.target.files[0])}function i(){a.isConnected?t("disconnect"):t("connect")}return(a,l)=>(u(),h("div",re,[L(ee,{id:"plugBtn",class:M(["tool",e.isConnected?"connected":""]),"data-tippy-content":e.isConnected?"Disconnect":"Connect",onClick:i},{default:g((()=>[p("i",{class:M([e.isConnected?"fa-plug-circle-xmark":"fa-plug","fas fa-fw"])},null,2)])),_:1},8,["class","data-tippy-content"]),L(ee,{disabled:e.disabled||!e.canRecord,class:"tool record","data-tippy-content":"Record",onClick:l[0]||(l[0]=e=>t("record"))},{default:g((()=>[ce])),_:1},8,["disabled"]),L(ee,{disabled:e.disabled||!e.canPlay,class:"tool play","data-tippy-content":"Play",onClick:l[1]||(l[1]=e=>t("play"))},{default:g((()=>[de])),_:1},8,["disabled"]),L(ee,{disabled:!e.isConnected||!e.disabled,class:"tool stop","data-tippy-content":"Stop",onClick:l[2]||(l[2]=e=>t("stop"))},{default:g((()=>[ue])),_:1},8,["disabled"]),L(ee,{disabled:e.disabled||!e.canList,class:"tool","data-tippy-content":"List",onClick:l[3]||(l[3]=e=>t("list",e.target))},{default:g((()=>[he])),_:1},8,["disabled"]),L(ee,{disabled:!e.canDownload,class:"tool","data-tippy-content":"Download",onClick:l[4]||(l[4]=e=>t("download"))},{default:g((()=>[pe])),_:1},8,["disabled"]),p("label",fe,[me,p("input",{id:"file",type:"file",class:"hidden",onChange:s},null,32)])]))}},we={},ge={id:"footer",class:"p-2 sm:p-4 flex flex-col space-y-2"},ye={class:"flex items-center justify-center space-x-8 sm:space-x-0 sm:justify-between"},be=T('<a href="https://ghielectronics.com" target="_blank"><svg class="h-8 w-auto" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 706 297" preserveAspectRatio="xMidYMid meet" aria-hidden="true"><g transform="translate(0, 297) scale(0.1, -0.1)" fill="currentColor" stroke="none"><path d="M850 2961 c-62 -7 -94 -22 -106 -48 -5 -10 -9 -90 -9 -178 l0 -160 -34 -70 c-44 -88 -154 -200 -238 -241 -57 -29 -61 -29 -213 -27 -177 3 -226 -6 -240 -43 -13 -34 -12 -360 1 -407 16 -57 48 -67 218 -67 108 0 153 -4 200 -19 122 -38 203 -107 262 -223 32 -62 33 -66 39 -238 6 -182 12 -210 53 -232 27 -15 399 -13 428 2 36 20 43 52 47 203 5 176 -2 228 -32 264 -23 27 -25 27 -192 34 -185 8 -204 12 -294 60 -228 121 -301 454 -152 685 45 70 115 134 180 166 41 20 69 23 221 30 96 4 187 12 203 19 47 19 59 57 65 198 7 161 -1 233 -32 269 -23 27 -23 27 -172 28 -81 1 -173 -1 -203 -5z"></path><path d="M1515 2961 c-40 -17 -43 -31 -47 -221 l-3 -185 -38 -72 c-48 -90 -125 -164 -213 -205 -63 -30 -74 -31 -247 -39 -175 -8 -182 -9 -207 -34 l-25 -25 0 -200 0 -199 28 -28 27 -28 153 -1 c90 0 170 -6 197 -13 184 -53 297 -191 330 -408 31 -197 -81 -399 -270 -490 -67 -33 -85 -37 -176 -41 -84 -4 -114 -1 -172 17 -132 40 -247 138 -306 261 -31 65 -31 66 -31 232 l0 167 -28 28 -27 28 -205 0 c-272 0 -250 22 -250 -250 l0 -205 25 -25 c34 -33 100 -41 206 -25 94 15 153 7 233 -32 60 -29 162 -127 216 -208 l45 -68 1 -158 c1 -266 0 -266 291 -262 174 3 199 5 215 21 16 16 18 39 18 200 0 182 0 182 30 242 40 81 152 193 230 230 59 29 64 29 231 30 187 1 214 8 235 63 6 15 9 103 7 214 -4 247 11 231 -221 239 -109 4 -189 12 -219 22 -158 50 -249 168 -284 369 -41 234 23 385 213 509 l67 44 116 3 c79 3 136 -1 183 -12 248 -58 394 -260 372 -515 -13 -152 -7 -171 62 -197 38 -15 68 -16 216 -10 186 7 211 14 224 64 4 15 8 101 8 192 0 259 -2 261 -247 257 l-163 -2 -60 30 c-69 35 -190 150 -232 222 -27 47 -28 52 -33 240 -7 257 14 237 -253 240 -111 1 -211 -2 -222 -6z"></path><path d="M3540 2879 c-177 -23 -317 -116 -390 -260 -65 -127 -65 -127 -65 -649 l0 -475 27 -80 c63 -184 173 -289 354 -335 72 -19 112 -20 626 -20 l548 0 -2 538 -3 537 -387 3 -388 2 0 -200 0 -200 195 0 195 0 0 -145 0 -145 -320 0 c-348 0 -361 2 -412 56 -15 16 -32 42 -37 57 -7 18 -11 164 -11 408 0 401 2 422 48 472 47 52 42 52 567 57 l490 5 0 190 0 190 -485 1 c-267 1 -514 -2 -550 -7z"></path><path d="M4787 2884 c-4 -4 -7 -416 -7 -916 l0 -908 225 0 225 0 0 390 0 390 385 0 385 0 0 -390 0 -390 220 0 220 0 -2 913 -3 912 -217 3 -218 2 0 -365 0 -365 -385 0 -385 0 -2 363 -3 362 -216 3 c-118 1 -218 -1 -222 -4z"></path><path d="M6610 2618 l0 -273 215 215 215 215 0 57 0 58 -215 0 -215 0 0 -272z"></path><path d="M6822 2427 l-212 -212 0 -578 0 -577 215 0 215 0 0 790 c0 435 -1 790 -3 790 -1 0 -98 -96 -215 -213z"></path><path d="M1560 2229 c-81 -16 -85 -25 -88 -223 -5 -264 0 -270 223 -281 168 -8 249 -28 325 -83 127 -91 212 -286 197 -450 -16 -164 -179 -359 -341 -407 -40 -12 -79 -14 -186 -9 -151 8 -192 -3 -210 -52 -6 -14 -10 -109 -10 -210 l0 -186 30 -29 30 -30 210 3 c202 3 210 4 232 26 21 21 22 29 18 110 -10 202 -6 243 28 315 38 82 112 162 210 228 l74 49 174 0 c182 0 223 8 238 45 11 30 7 392 -5 418 -18 39 -50 47 -194 47 -74 0 -158 5 -187 11 -114 24 -212 89 -266 178 -52 84 -63 133 -71 306 -8 182 -17 207 -80 225 -43 12 -288 11 -351 -1z"></path><path d="M6110 865 c0 -33 2 -35 35 -35 33 0 35 2 35 35 0 33 -2 35 -35 35 -33 0 -35 -2 -35 -35z"></path><path d="M3590 625 l0 -265 35 0 35 0 0 265 0 265 -35 0 -35 0 0 -265z"></path><path d="M4668 785 c-11 -40 -15 -45 -40 -45 -24 0 -28 -4 -28 -30 0 -25 4 -30 24 -30 l24 0 4 -141 c3 -140 3 -141 31 -165 45 -39 137 -31 137 12 0 21 -5 24 -35 24 -48 0 -55 19 -55 154 l0 116 45 0 c43 0 45 1 45 30 0 29 -2 30 -45 30 l-45 0 0 45 c0 41 -2 45 -25 45 -21 0 -27 -7 -37 -45z"></path><path d="M3227 726 c-80 -29 -111 -80 -111 -181 1 -104 38 -162 119 -184 85 -23 162 -6 215 47 l35 36 -35 7 c-28 6 -39 4 -57 -13 -16 -15 -40 -23 -77 -26 -51 -4 -57 -2 -86 26 -20 21 -30 40 -30 61 l0 31 145 0 c164 0 158 -3 134 83 -28 103 -139 153 -252 113z m136 -58 c28 -15 46 -38 47 -60 0 -16 -12 -18 -105 -18 -97 0 -105 2 -105 19 0 11 14 31 31 45 34 29 93 35 132 14z"></path><path d="M3867 726 c-80 -29 -111 -80 -111 -181 1 -104 38 -162 119 -184 85 -23 162 -6 215 47 l35 36 -35 7 c-28 6 -39 4 -57 -13 -16 -15 -40 -23 -77 -26 -51 -4 -57 -2 -86 26 -20 21 -30 40 -30 61 l0 31 145 0 c164 0 158 -3 134 83 -28 103 -139 153 -252 113z m136 -58 c28 -15 46 -38 47 -60 0 -16 -12 -18 -105 -18 -97 0 -105 2 -105 19 0 11 14 31 31 45 34 29 93 35 132 14z"></path><path d="M4305 725 c-84 -29 -127 -128 -104 -235 23 -108 124 -162 241 -130 48 14 93 52 107 90 10 30 9 30 -25 30 -27 0 -43 -8 -68 -35 -28 -29 -40 -35 -75 -35 -33 0 -49 6 -71 28 -53 53 -49 178 7 221 43 35 135 22 148 -21 5 -13 16 -18 46 -18 49 0 51 16 8 64 -47 54 -131 70 -214 41z"></path><path d="M4900 550 l0 -190 34 0 33 0 5 118 c7 158 30 202 107 202 28 0 31 3 31 31 0 31 0 32 -42 26 -41 -5 -55 -16 -85 -63 -10 -16 -12 -13 -12 24 -1 41 -2 42 -36 42 l-35 0 0 -190z"></path><path d="M5281 728 c-83 -23 -124 -84 -125 -183 0 -125 69 -190 200 -190 60 1 78 5 111 27 94 62 109 224 29 304 -49 49 -134 66 -215 42z m148 -76 c19 -18 30 -43 35 -73 7 -45 5 -55 -16 -112 -28 -74 -163 -75 -196 -2 -16 34 -15 134 2 164 18 33 53 50 104 51 35 0 49 -6 71 -28z"></path><path d="M5640 550 l0 -190 34 0 34 0 4 118 c5 129 18 170 63 190 62 28 118 5 135 -56 5 -20 10 -85 10 -144 l0 -108 36 0 35 0 -3 154 -3 155 -29 30 c-53 55 -154 53 -212 -6 l-34 -34 0 41 c0 39 -1 40 -35 40 l-35 0 0 -190z"></path><path d="M6110 550 l0 -190 35 0 35 0 0 190 0 190 -35 0 -35 0 0 -190z"></path><path d="M6385 725 c-84 -29 -127 -128 -104 -235 23 -108 124 -162 241 -130 48 14 93 52 107 90 10 30 9 30 -25 30 -27 0 -43 -8 -68 -35 -28 -29 -40 -35 -75 -35 -33 0 -49 6 -71 28 -53 53 -49 178 7 221 43 35 135 22 148 -21 5 -13 16 -18 46 -18 49 0 51 16 8 64 -47 54 -131 70 -214 41z"></path><path d="M6785 725 c-22 -8 -41 -15 -42 -15 -9 0 -33 -64 -33 -88 0 -53 46 -85 150 -104 66 -11 100 -31 100 -58 0 -60 -153 -70 -195 -13 -8 11 -19 12 -44 6 l-32 -8 23 -35 c36 -53 127 -73 224 -49 106 27 128 146 36 193 -15 8 -54 19 -87 26 -99 20 -130 51 -83 84 35 25 104 21 132 -7 18 -18 32 -23 55 -19 17 2 31 6 31 8 0 19 -30 59 -54 71 -43 22 -133 26 -181 8z"></path></g></svg></a>',1),ke={class:"hidden text-center sm:block"},xe=T('<div class="text-4xl flex space-x-4"><a href="https://www.facebook.com/ghielectronics/" target="_blank"><i class="fab fa-facebook-square"></i></a><a href="https://www.twitter.com/GHIElectronics" target="_blank"><i class="fab fa-twitter-square"></i></a><a href="https://www.youtube.com/user/GHIElectronics" target="_blank"><i class="fab fa-youtube-square"></i></a><a href="https://www.linkedin.com/company/ghielectronics/" target="_blank"><i class="fab fa-linkedin"></i></a></div>',1),Ee={class:"text-center text-sm sm:hidden"};we.render=function(e,t){return u(),h("div",ge,[p("div",ye,[be,p("div",ke," © GHI Electronics "+b((new Date).getFullYear()),1),xe]),p("div",Ee," © GHI Electronics "+b((new Date).getFullYear()),1)])};const Ce=p("div",{class:"fixed inset-0 bg-slate-500 dark:bg-black bg-opacity-75 dark:bg-opacity-75 transition-opacity"},null,-1),_e={class:"fixed inset-0 z-10 overflow-y-auto"},Oe={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},Me={class:"mt-2"},Le={class:"mt-5 sm:mt-6"},Te={props:{open:Boolean,maxWidthClass:{type:String,default:"sm:max-w-sm"}},setup:e=>(t,a)=>(u(),w(_(A),{as:"template",show:e.open},{default:g((()=>[L(_(S),{as:"div",class:"relative z-10",onClose:a[0]||(a[0]=t=>e.open=!1)},{default:g((()=>[L(_(D),{as:"template",enter:"ease-out duration-150","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-150","leave-from":"opacity-100","leave-to":"opacity-0"},{default:g((()=>[Ce])),_:1}),p("div",_e,[p("div",Oe,[L(_(D),{as:"template",enter:"ease-out duration-150","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-150","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:g((()=>[L(_(R),{class:M([e.maxWidthClass,"relative transform overflow-hidden rounded-lg bg-white dark:bg-zinc-800 px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:p-6 sm:w-full"])},{default:g((()=>[p("div",null,[L(_(B),{as:"h3",class:"text-base font-semibold leading-6 text-sky-600 dark:text-lime-300"},{default:g((()=>[f(t.$slots,"title")])),_:3}),p("div",Me,[f(t.$slots,"default")])]),p("div",Le,[f(t.$slots,"buttons")])])),_:3},8,["class"])])),_:3})])])])),_:3})])),_:3},8,["show"]))};var De={};
/**
 * Instantiate by `var xmodem = require('xmodem');`
 * @class
 * @classdesc XMODEM Protocol in JavaScript
 * @name Xmodem
 * @license BSD-2-Clause
 */class Re extends z{constructor(){super(...arguments),t(this,"log",{info:e=>{},warn:e=>{},error:e=>{},debug:e=>{}}),t(this,"SOH",1),t(this,"STX",2),t(this,"EOT",4),t(this,"ACK",6),t(this,"NAK",21),t(this,"CAN",24),t(this,"FILLER",26),t(this,"CRC_MODE",67),t(this,"receive_interval_timer",!1),t(this,"XMODEM_MAX_TIMEOUTS",5),t(this,"XMODEM_MAX_ERRORS",10),t(this,"XMODEM_CRC_ATTEMPTS",3),t(this,"XMODEM_OP_MODE","crc"),t(this,"XMODEM_START_BLOCK",1),t(this,"timeout_seconds",10),t(this,"block_size",1024)}static get VERSION(){return require("../../../package.json").version}async send(e,t,a,s){this.log.info("Bytes to send : "+a.length),await this.sendLoop(e,t,new Uint8Array(a),s)}async sendLoop(e,t,a,s){for(var i=this.XMODEM_START_BLOCK,l=[],n=P.Buffer.alloc(this.block_size),o=!1,r=0;r<this.XMODEM_START_BLOCK;r++)l.push("");for(;a.length>0;){for(r=0;r<this.block_size;r++)n[r]=void 0===a[r]?this.FILLER:a[r];a=a.slice(this.block_size),l.push(n),n=P.Buffer.alloc(this.block_size)}for(this.emit("ready",l.length-1);!o;)try{s&&s(i,l.length);const{value:a,done:n}=await e.read();if(a){var c=[...a],d=" ";do{d=c.shift()}while(d===this.CRC_MODE&&c.length>0);if(d===this.CRC_MODE&&i!==this.XMODEM_START_BLOCK)continue;d===this.CRC_MODE&&i===this.XMODEM_START_BLOCK?(this.log.info("[SEND] - received C byte for CRC transfer!"),this.XMODEM_OP_MODE="crc",l.length>i&&(this.emit("start",this.XMODEM_OP_MODE),this.sendBlock(t,i,l[i],this.XMODEM_OP_MODE),this.emit("status",{action:"send",signal:"STX",block:i}),i++)):d===this.NAK&&i===this.XMODEM_START_BLOCK?(this.log.info("[SEND] - received NAK byte for standard checksum transfer!"),this.XMODEM_OP_MODE="normal",l.length>i&&(this.emit("start",this.XMODEM_OP_MODE),this.sendBlock(t,i,l[i],this.XMODEM_OP_MODE),this.emit("status",{action:"send",signal:"STX",block:i}),i++)):d===this.ACK&&i>this.XMODEM_START_BLOCK?(this.log.info("ACK RECEIVED"),this.emit("status",{action:"recv",signal:"ACK"}),l.length>i?(this.sendBlock(t,i,l[i],this.XMODEM_OP_MODE),this.emit("status",{action:"send",signal:"STX",block:i}),i++):l.length===i&&(!1===o?(o=!0,this.log.info("WE HAVE RUN OUT OF STUFF TO SEND, EOT EOT!"),this.emit("status",{action:"send",signal:"EOT"}),t.write(P.Buffer.from([this.EOT]))):(this.log.info("[SEND] - Finished!"),this.emit("stop",0)))):d===this.NAK&&i>this.XMODEM_START_BLOCK?i===l.length&&o?(this.log.info("[SEND] - Resending EOT, because receiver responded with NAK."),this.emit("status",{action:"send",signal:"EOT"}),t.write(P.Buffer.from[this.EOT])):(this.log.info("[SEND] - Packet corruption detected, resending previous block."),this.emit("status",{action:"recv",signal:"NAK"}),i--,l.length>i&&(this.sendBlock(t,i,l[i],this.XMODEM_OP_MODE),this.emit("status",{action:"send",signal:"STX",block:i}),i++)):(this.log.warn("GOT SOME UNEXPECTED DATA which was not handled properly!"),this.log.warn("===>"),this.log.warn("command : "+d),this.log.warn("value : "+c),this.log.warn("<==="),this.log.warn("blockNumber: "+i))}if(n||o)break}catch(u){}}setIntervalX(e,t,a){var s=0,i=setInterval((function(){++s===a&&(clearInterval(i),this.receive_interval_timer=!1),e()}),t);return i}sendBlock(e,t,a,s){var i=0,l=P.Buffer.concat([P.Buffer.from([this.STX]),P.Buffer.from([t]),P.Buffer.from([255-t]),a]);if(this.log.info("SENDBLOCK! Data length: "+a.length),this.log.info(l),"crc"===s){var n=F.crc16xmodem(a).toString(16);n.length%2==1&&(n="0".concat(n)),2===n.length&&(n="00".concat(n)),l=P.Buffer.concat([l,P.Buffer.from(n,"hex")])}else{for(var o=3;o<l.length;o++)i+=l.readUInt8(o);(i=(i%=256).toString(16)).length%2!=0&&(i="0"+i),l=P.Buffer.concat([l,P.Buffer.from(i,"hex")])}this.log.info("Sending buffer with total length: "+l.length),e.write(l)}receiveBlock(e,t,a,s,i,l){var n,o=a[0],r=parseInt(a[1]),c=parseInt(a[2]),d="crc"===i?2:1;if(o===this.STX){if(r+c!==255)return this.log.error("ERROR: Block integrity check failed!"),void e.write(P.Buffer.from([this.NAK]));if(r===t%256)return(n=a.slice(3,a.length-d)).length!==s?(this.log.error("ERROR: Received block size did not match the expected size. Received: "+n.length+" | Expected: "+s),void e.write(P.Buffer.from([this.NAK]))):(e.write(P.Buffer.from([this.ACK])),void l(n));this.log.error("ERROR: Synch issue! Received: "+r+" Expected: "+t)}else this.log.error("ERROR!")}writeFile(e,t,a){this.log.info("writeFile called");var s=De.createWriteStream(t);s.once("open",(function(t){this.log.info("File stream opened, buffer length: "+e.length);for(var i=0;i<e.length;i++)s.write(e[i]);s.end(),this.log.info("File written"),a()}))}}class Be{constructor(){this.port=null,this.writer=null,this.reader=null,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.inputStream=null,this.outputStream=null,this.respq=new a,this.xmodem=new Re,this.readLoopPromise=null,this.enableReadLoop=!1}async open(e){try{this.port=e,await this.attach(),this.startReadLoop()}catch(t){throw alert(t),this.port=null,t}}async readLoop(){let e="",t=0;for(this.enableReadLoop=!0;this.enableReadLoop;)try{const{value:a,done:s}=await this.reader.read();if(a){e+=this.decoder.decode(a);let s=e.indexOf("\n");for(;s>=0;){let a=e.substr(0,s).replace("\r","");t<2&&(t=a.includes("Bootloader")?0:a.includes("------")?1:a.includes("OK.")?2:3),3===t&&this.respq.push(a),e=e.substr(s+1),s=e.indexOf("\n"),2===t&&(t=3)}}s&&(this.enableReadLoop=!1)}catch(a){break}}async attach(){var e,t;if(await this.port.open({baudRate:115200,dataBits:8,parity:"none",stopBits:1,flowControl:"none",baudrate:115200,databits:8,stopbits:1,rtscts:!1}),null==(null==(e=this.port)?void 0:e.writable))throw new Error("This is not a writable port");if(null==(null==(t=this.port)?void 0:t.readable))throw new Error("This is not a readable port");this.reader=this.port.readable.getReader(),this.writer=this.port.writable.getWriter()}startReadLoop(){this.readLoopPromise=this.readLoop()}async stopReadLoop(){this.enableReadLoop=!1,this.readLoopPromise&&(await this.reader.cancel(),await this.readLoopPromise,this.readLoopPromise=null)}async detach(){await this.stopReadLoop(),await this.writer.releaseLock(),await this.reader.releaseLock(),await this.port.close()}async close(){await this.detach()}ensureOpen(){if(!this.port)throw new Error("port not opened")}async readUntil(e){const t=[];let a="";do{a=await this.respq.pop(),t.push(a)}while(!a.startsWith(e));return t}async readUntilEmpty(){const e=[];let t="";do{t=await this.respq.tryPop(),t&&e.push(t)}while(t);return e}async sendCommand(e){await this.readUntilEmpty(),this.writer.write(this.encoder.encode(e+"\n"))}async sendAndExpect(e,t){return await this.sendCommand(e),await this.readUntil(t)}async sendConfirmAndExpect(e,t){await this.sendCommand(e);(await this.respq.pop()).endsWith("?")&&await this.sendAndExpect("Y",t)}async loaderVersion(){this.ensureOpen();return(await this.sendAndExpect("v","OK."))[0]}async erase(){this.ensureOpen(),await this.sendConfirmAndExpect("E","OK.")}async flash(e,t,a){this.ensureOpen(),t?await this.sendConfirmAndExpect("U","Waiting..."):await this.sendConfirmAndExpect("X","Waiting..."),await this.detach(),await this.attach();try{await this.xmodem.send(this.reader,this.writer,e,a)}catch(s){}this.startReadLoop()}}const Se=y(" Update Firmware Steps "),Ae=p("ol",{class:"mb-4 ol-reset space-y-2 leading-loose"},[p("li",null,"Connect your board to the computer."),p("li",null,[y(" On your board, hold down the "),p("kbd",null,"A"),y(" button while pressing and releasing the "),p("kbd",null,"RESET"),y(" button once. "),p("span",{class:"font-semibold"},[y("Keep holding the "),p("kbd",null,"A"),y(" button down,")]),y(" wait for a second, and then release it. "),p("ul",{class:"mt-2 ul-reset text-[#f08000]"},[p("li",null,"This will put restart your board in bootloader mode.")])]),p("li",null,[y("Click the connect button below and select the "),p("em",null,"GHI Bootloader Interface"),y(".")]),p("li",null,[y(" Select the desired firmware and click "),p("em",null,"Load"),y(". "),p("ul",{class:"mt-2 ul-reset text-[#f08000]"},[p("li",null,"This will completely erase your board.")])]),p("li",null,[y("Once "),p("span",{class:"font-semibold"},"Loading is complete"),y(", press and release the "),p("kbd",null,"RESET"),y(" button.")]),p("li",null,"You may now begin using the board.")],-1),ze={key:0,class:"mb-4 rounded-md bg-red-50 p-4"},Pe={class:"flex"},Fe=p("div",{class:"flex-shrink-0"}," [Icon] ",-1),Ue={class:"ml-3"},Xe=p("h3",{class:"text-sm font-medium text-red-800"}," An error has occurred ",-1),je={class:"mt-2 text-sm text-red-700"},Ke={role:"list",class:"list-disc pl-5 space-y-1"},Ie=["innerHTML"],Ne={class:"ml-auto pl-3"},$e={class:"-mx-1.5 -my-1.5"},qe=[p("span",{class:"sr-only"},"Dismiss",-1),y(" [Icon] ")],We={key:1},He={key:0,class:"grid grid-cols-6 gap-2"},Ve={class:"col-span-4"},Ge=p("label",{for:"firmware"},"Firmware",-1),Ye=p("option",{value:"",disabled:""},"Select",-1),Je=["value"],Qe={class:"col-span-2"},Ze=p("label",{for:"version"},"Version",-1),et=["disabled"],tt=["value"],at={key:1,class:"firmware-progress-box"},st=[p("div",{class:"w-full"},[p("div",{class:"mb-2 text-sky-600 dark:text-lime-400"},"Erasing..."),p("div",{class:"w-full h-2 bg-slate-300 dark:bg-zinc-700"})],-1)],it={key:2,class:"firmware-progress-box"},lt={class:"w-full"},nt={class:"mb-2 text-sky-600 dark:text-lime-400"},ot={class:"w-full h-2 bg-slate-300 dark:bg-zinc-700"},rt={key:3,class:"firmware-progress-box"},ct=[p("div",{class:"w-full"},[p("div",{class:"mb-2 text-sky-600 dark:text-lime-400"},"Loading... 100%"),p("div",{class:"w-full h-2 bg-sky-500 dark:bg-lime-500"})],-1)],dt={class:"flex space-x-2"},ut=y(" Update "),ht=y(" Disconnect "),pt=y(" Update "),ft=y(" Disconnect "),mt=y(" Done "),vt=y(" Restart "),wt=y(" Connect "),gt=y(" Close "),yt={props:{availableFirmware:{type:Object,required:!0},open:Boolean},emits:["close"],setup(e,{emit:t}){const a=e,i=s(""),n=s(""),o=new Be,r=s(!1),c=s(null),f=s("idle"),y=s(null),x=s(0);let E;function C(e){"string"==typeof e&&e.indexOf("No port selected by the user.")>-1||(e.value=e,r.value=!1,E=void 0)}async function _(){if(!r.value){c.value=null;try{E=await navigator.serial.requestPort({}),await o.open(E),r.value=!0}catch(e){C(e)}}}async function O(){if(r.value){c.value=null;try{await o.close(),r.value=!1,E=void 0,f.value="idle"}catch(e){C(e)}}}async function M(){await O(),t("close")}function T(){f.value="idle",i.value="",n.value=""}async function D(){c.value=null,x.value=0,a.availableFirmware[i.value].image||(c.value="Failed to load firmware from the server &mdash; cannot program the device."),f.value="erasing",await o.erase(),f.value="writing",await o.flash(a.availableFirmware[i.value].image,a.availableFirmware[i.value].isGlb,((e,t)=>function(e,t){y.value=e<3?"Erasing":"Loading",x.value=Math.round(e/t*100),x.value>=100&&(f.value="complete")}(e,t)))}return l((()=>n.value),(async e=>{const t=a.availableFirmware[i.value].versions[e].url,s=`download_${await async function(e){const t=(new TextEncoder).encode(e),a=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(a)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t)}`;let l=null;const n=await fetch(t);if(n.ok){l=await n.blob();const e=await l.arrayBuffer();await async function(e,t){const a=new FileReader;a.onload=function(t){try{localStorage.setItem(e,t.target.result)}catch(a){a.value="Failed to store firmware image."}},a.readAsDataURL(t)}(s,l),a.availableFirmware[i.value].image=e}else c.value=`Unable to download the firmware (${n.status}).`,a.availableFirmware[i.value].image=null})),(a,s)=>(u(),w(Te,{open:e.open,"max-width-class":"sm:max-w-xl"},{title:g((()=>[Se])),buttons:g((()=>[p("div",dt,[r.value?(u(),h(m,{key:0},["idle"===f.value?(u(),h(m,{key:0},[L(ee,{disabled:!i.value||!e.availableFirmware[i.value].image,onClick:D},{default:g((()=>[ut])),_:1},8,["disabled"]),L(ee,{type:"secondary",onClick:O},{default:g((()=>[ht])),_:1})],64)):k("",!0),"erasing"===f.value||"writing"===f.value?(u(),h(m,{key:1},[L(ee,{disabled:""},{default:g((()=>[pt])),_:1}),L(ee,{disabled:"",type:"secondary"},{default:g((()=>[ft])),_:1})],64)):"complete"===f.value?(u(),h(m,{key:2},[L(ee,{onClick:M},{default:g((()=>[mt])),_:1}),L(ee,{type:"secondary",onClick:T},{default:g((()=>[vt])),_:1})],64)):k("",!0)],64)):(u(),h(m,{key:1},[L(ee,{onClick:_},{default:g((()=>[wt])),_:1}),L(ee,{type:"secondary",onClick:s[3]||(s[3]=e=>t("close"))},{default:g((()=>[gt])),_:1})],64))])])),default:g((()=>{var t,a;return[Ae,c.value?(u(),h("div",ze,[p("div",Pe,[Fe,p("div",Ue,[Xe,p("div",je,[p("ul",Ke,[p("li",{innerHTML:c.value},null,8,Ie)])])]),p("div",Ne,[p("div",$e,[p("button",{onClick:s[0]||(s[0]=e=>c.value=null),type:"button",class:"inline-flex bg-red-50 rounded-md p-1.5 text-red-500 hover:bg-red-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-red-50 focus:ring-red-600"},qe)])])])])):k("",!0),r.value?(u(),h("div",We,["idle"===f.value?(u(),h("div",He,[p("div",Ve,[Ge,d(p("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),id:"firmware",class:"mt-2"},[Ye,(u(!0),h(m,null,v(e.availableFirmware,((e,t)=>(u(),h("option",{key:t,value:t},b(e.name)+" ("+b(e.boards.map((e=>e.name)).join(", "))+") ",9,Je)))),128))],512),[[U,i.value]])]),p("div",Qe,[Ze,d(p("select",{"onUpdate:modelValue":s[2]||(s[2]=e=>n.value=e),disabled:!i.value,id:"version",class:"mt-2"},[(u(!0),h(m,null,v((null==(a=null==(t=e.availableFirmware)?void 0:t[i.value])?void 0:a.versions.sort(((e,t)=>t.id-e.id)))||[],((e,t)=>(u(),h("option",{key:t,value:t},b(e.name),9,tt)))),128))],8,et),[[U,n.value]])])])):"erasing"===f.value?(u(),h("div",at,st)):"writing"===f.value?(u(),h("div",it,[p("div",lt,[p("div",nt,"Loading... "+b(x.value)+"%",1),p("div",ot,[p("div",{class:"h-2 bg-sky-500 dark:bg-lime-500",style:X(`width:${x.value}%`)},null,4)])])])):"complete"===f.value?(u(),h("div",rt,ct)):k("",!0)])):k("",!0)]})),_:1},8,["open"]))}},bt={class:"flex-1 flex items-center justify-between"},kt={class:"flex items-center space-x-2"},xt={props:{autoScroll:Boolean,title:String},setup(e,{expose:t}){const a=e;t({open:function(){o.value=!0}});const i={slot:null};let l=null;const o=s(!0);return a.autoScroll&&(r((()=>{n((()=>{i.slot&&(l=new MutationObserver((()=>i.slot.scrollTop=i.slot.scrollHeight)),l.observe(i.slot,{attributes:!1,childList:!0,characterData:!0,subtree:!0}))}))})),j((()=>l.disconnect()))),(t,a)=>(u(),h("div",null,[p("div",{class:"panel-bar flex items-center px-4 py-2 cursor-pointer select-none transition duration-150 ease-in-out",onClick:a[0]||(a[0]=e=>o.value=!o.value)},[p("div",bt,[p("div",kt,[p("i",{class:M(["fas fa-fw",o.value?"fa-angle-down":"fa-angle-right"])},null,2),p("span",null,b(e.title),1)]),f(t.$slots,"buttons")])]),d(p("div",{ref:e=>i.slot=e,class:"panel-content max-h-[400px] overflow-y-auto"},[f(t.$slots,"default")],512),[[O,o.value]])]))}},Et=p("i",{class:"fas fa-fw fa-eraser"},null,-1),Ct={class:"p-2 whitespace-pre-wrap"},_t={props:{output:Array},setup(e){const t=e,a=i((()=>t.output.filter((e=>e&&["\n","$",">","&"].every((t=>!e.startsWith(t))))).join("\n")));return(t,s)=>(u(),w(xt,{"auto-scroll":"",title:"Output"},{buttons:g((()=>[L(ee,{disabled:!e.output.length,"data-tippy-content":"Clear",onClick:s[0]||(s[0]=x((e=>t.$emit("update:output",[])),["stop"]))},{default:g((()=>[Et])),_:1},8,["disabled"])])),default:g((()=>[p("div",Ct,b(_(a)?_(a):" "),1)])),_:1}))}},Ot={class:"p-2 text-sm divide-y divide-slate-300 dark:divide-zinc-700"},Mt=p("div",{class:"px-2 py-1 flex justify-between"},[p("div",{class:"font-medium"},"Console"),p("div",null," v1.0.0 ")],-1),Lt={class:"px-2 py-1 flex justify-between"},Tt=p("div",{class:"font-medium"},"Device",-1),Dt={class:"px-2 py-1 flex justify-between"},Rt=p("div",{class:"font-medium"},"Device firmware",-1),Bt={class:"px-2 py-1 flex justify-between"},St=p("div",{class:"font-medium"},"Latest firmware",-1),At={key:0,class:"px-4 py-2 font-medium bg-yellow-200 dark:text-zinc-900"},zt=[p("i",{class:"fas fa-fw fa-triangle-exclamation mr-1"},null,-1),y(" Please update to the latest firmware. ")],Pt={props:{availableFirmware:Object,version:String},setup(e){const t=e,a=i((()=>t.version?t.version.substring(t.version.length-1,t.version.length):null)),s=i((()=>t.version?t.version.substring(0,t.version.length-1):null)),l=i((()=>Object.values(t.availableFirmware).find((e=>((null==e?void 0:e.boards)||[]).find((e=>e.id===a.value)))))),n=i((()=>{if(l.value){const e=l.value.boards.find((e=>e.id===a.value));if(e)return e.name}return null})),o=i((()=>l.value&&s.value?`${l.value.name} ${s.value}`:null)),r=i((()=>{if(l.value){const e=Math.max(...l.value.versions.map((e=>e.id))),t=l.value.versions.find((t=>t.id===e));return`${l.value.name} ${t.name}`}return null}));return(e,t)=>(u(),h(m,null,[L(xt,{title:"About"},{default:g((()=>[p("div",Ot,[Mt,p("div",Lt,[Tt,p("div",null,b(_(n)?_(n):"..."),1)]),p("div",Dt,[Rt,p("div",null,b(_(o)?_(o):"..."),1)]),p("div",Bt,[St,p("div",null,b(_(r)?_(r):"..."),1)])])])),_:1}),null!==_(o)&&null!==_(r)&&_(o)!==_(r)?(u(),h("div",At,zt)):k("",!0)],64))}},Ft={id:"progress-bar"},Ut={class:"min-h-screen flex flex-col space-y-0.5"},Xt={class:"flex-1 flex flex-col space-y-0.5 sm:space-y-0 sm:flex-row sm:space-x-0.5"},jt={id:"editor",class:"flex-1 p-2 flex flex-col"},Kt={id:"direct-bar",class:"p-2 sm:pl-[42px] flex space-x-2"},It={class:"flex-1"},Nt={class:"relative"},$t=[p("i",{class:"fas fa-fw fa-xmark"},null,-1)],qt=["onKeyup"],Wt=p("i",{class:"fas fa-fw fa-arrow-right"},null,-1),Ht={id:"side-bar",class:"sm:w-1/2 lg:w-1/3 p-2 space-y-0.5"},Vt=p("div",{id:"spacer"},null,-1),Gt=y(" Heads up! "),Yt=p("div",null,"You already have code in the editor.",-1),Jt=p("div",null,"Do you want to replace it?",-1),Qt={class:"flex space-x-2"},Zt=y(" Yes "),ea=y(" No "),ta=y(" Download "),aa=p("div",{class:"mb-2"},"What would you like to name the file?",-1),sa=p("label",{for:"filename"},"File name",-1),ia={class:"flex space-x-2"},la=y(" Download "),na=y(" Cancel "),oa={setup(e){const t={editor:null,filename:null,input:null,progress:null},a=K({}),o=s(""),c=s(""),f=s(""),v=s(1),w=s(1),y=s(""),b=s("javascript"),k=K(new G),x=s("light"),E={animation:"fade",appendTo:document.body,interactive:!0,placement:"bottom",theme:"light"},C=K({lines:[],list:!1,open:!1,target:null,async yes(){this.list&&(this.list=!1,this.lines=await k.write("list")),this.lines.length&&(o.value=this.lines.join("\n"),this.lines=[]),this.open=!1,this.fixTippy()},async no(){this.list&&(this.list=!1,await k.write("list")),this.open=!1,this.fixTippy()},fixTippy(){var e;(null==(e=null==this?void 0:this.target)?void 0:e._tippy)&&(this.target._tippy.destroy(),setTimeout((()=>{E.theme=x.value,I(this.target,E)}),200))}}),O=K({open:!1,start(){k.isConnected&&k.disconnect(),this.open=!0}}),T=K({open:!1,start(){this.open=!0,n((()=>t.filename.focus()))},download(){!function(e){if(!o.value.length||!e.length)return;const t=new Blob([o.value],{type:"text/csv"}),a=window.document.createElement("a");a.href=window.URL.createObjectURL(t),a.download=`${e}.txt`,document.body.appendChild(a),a.click(),document.body.removeChild(a)}(y.value),this.cancel()},cancel(){y.value="",this.open=!1}});let D=[];const R=i((()=>!k.isConnected||k.isBusy||k.isTalking));async function B(e){o.value?(C.lines=e.slice(0),C.open=!0):o.value=e.join("\n")}function S(e){o.value?(C.lines=e.slice(0),C.open=!0):o.value=e.join("\n")}async function A(){f.value=o.value,t.progress.style.width="0",t.progress.classList.remove("opacity-0");await k.write("pgmstream()","&");const e=o.value.replace(/\r/gm,"").replace(/\t/gm," ").split(/\n/);let a=0;for(let s of e)0===s.trim().length&&(s=" "),await k.stream(s+"\n"),t.progress.style.width=Math.trunc(++a/e.length*100)+"%";t.progress.style.width="100%",await k.stream("\0"),await k.readUntil(),t.progress.classList.add("opacity-0")}async function z(){await k.write(">");const e=c.value.replace(/\t/gm," ");k.output.push(e),await k.write(e)}async function P(){await k.write("run")}async function F(e){if(o.value)C.target=e,C.list=!0,C.open=!0;else{const e=(await k.write("list")).join("\n");o.value!==e&&(o.value=e,f.value=e)}}async function U(){await k.escape()}function X(e){e.setShowPrintMargin(!1),e.setOptions({fontSize:"16px"}),e.session.selection.on("changeCursor",(()=>{const t=e.getCursorPosition();v.value=t.row+1,w.value=t.column+1}))}function j(e,t=!1){e&&n((()=>{e._tippy?(e._tippy.setContent(e.getAttribute("data-tippy-content")),t&&e._tippy.show()):(E.theme=x.value,I([e],E))}))}function W(){D.forEach((e=>e.setProps({theme:x.value})))}return l((()=>k.isConnected),(e=>{const t=document.getElementById("plugBtn");t&&j(t),e||(f.value="")})),("dark"===localStorage.theme||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&(x.value="dark",E.theme="dark"),async function(){try{const e=await fetch("/firmware.json"),t=await e.json();Object.keys(t).forEach((e=>{a[e]=t[e],a[e].isGlb=!1,a[e].image=null}))}catch(e){}}(),r((()=>{D=I("[data-tippy-content]",E),window.onbeforeunload=function(){if(o.value)return!1}})),(e,s)=>(u(),h(m,null,[p("div",Ft,[p("div",{ref:e=>t.progress=e,class:"h-1 bg-sky-500 dark:bg-lime-500 transition duration-1000 ease-linear opacity-0"},null,512)]),p("div",Ut,[L(oe,{theme:x.value,"onUpdate:theme":[s[0]||(s[0]=e=>x.value=e),W],onDemo:B,onFirmware:s[1]||(s[1]=e=>_(O).start()),onUpdateTippy:j},null,8,["theme"]),L(ve,{"can-download":o.value.length>0,"can-list":!0,"can-load":!0,"can-play":""!==o.value&&o.value===f.value,"can-record":o.value.length>0&&o.value!==f.value,disabled:_(R),"is-connected":_(k).isConnected,onConnect:s[2]||(s[2]=e=>_(k).connect()),onDisconnect:s[3]||(s[3]=e=>_(k).disconnect()),onDownload:s[4]||(s[4]=e=>_(T).start()),onPlay:P,onStop:U,onRecord:A,onList:F,onLoad:S},null,8,["can-download","can-play","can-record","disabled","is-connected"]),p("div",Xt,[p("div",jt,[L(_(N),{value:o.value,"onUpdate:value":s[5]||(s[5]=e=>o.value=e),lang:b.value,ref:e=>t.editor=e,theme:"dark"===x.value?"tomorrow_night_bright":"crimson_editor",class:"flex-1",onInit:X},null,8,["value","lang","theme"]),p("div",Kt,[p("div",It,[p("div",Nt,[p("div",{class:"absolute right-0 inset-y-0 p-1 flex items-center justify-center rounded-r-md",onClick:s[6]||(s[6]=e=>{c.value="",t.input.focus()})},[p("div",{class:M([[c.value.length?"text-slate-400 hover:text-slate-900 dark:text-zinc-600 dark:hover:text-zinc-100":"hidden"],"flex items-center justify-center w-8 h-full rounded-md cursor-pointer hover:bg-slate-100 dark:hover:bg-zinc-900"])},$t,2)]),d(p("input",{"onUpdate:modelValue":s[7]||(s[7]=e=>c.value=e),ref:e=>t.input=e,placeholder:"Code to run immediately...",type:"text",onKeyup:q(z,["enter"])},null,40,qt),[[$,c.value]])])]),L(ee,{disabled:_(R),"data-tippy-content":"Execute",onClick:z},{default:g((()=>[Wt])),_:1},8,["disabled"])])]),p("div",Ht,[L(_t,{output:_(k).output,"onUpdate:output":s[8]||(s[8]=e=>_(k).output=e)},null,8,["output"]),L(Pt,{"available-firmware":_(a),version:_(k).version},null,8,["available-firmware","version"])])]),Vt,L(we)]),L(Te,{open:_(C).open},{title:g((()=>[Gt])),buttons:g((()=>[p("div",Qt,[L(ee,{class:"w-full",onClick:s[9]||(s[9]=e=>_(C).yes())},{default:g((()=>[Zt])),_:1}),L(ee,{class:"w-full",type:"secondary",onClick:s[10]||(s[10]=e=>_(C).no())},{default:g((()=>[ea])),_:1})])])),default:g((()=>[Yt,Jt])),_:1},8,["open"]),L(Te,{open:_(T).open},{title:g((()=>[ta])),buttons:g((()=>[p("div",ia,[L(ee,{disabled:0===y.value.length,class:"w-full",onClick:s[12]||(s[12]=e=>_(T).download())},{default:g((()=>[la])),_:1},8,["disabled"]),L(ee,{class:"w-full",type:"secondary",onClick:s[13]||(s[13]=e=>_(T).cancel())},{default:g((()=>[na])),_:1})])])),default:g((()=>[p("div",null,[aa,sa,d(p("input",{"onUpdate:modelValue":s[11]||(s[11]=e=>y.value=e),ref:e=>t.filename=e,class:"mt-2",id:"filename",type:"text"},null,512),[[$,y.value]])])])),_:1},8,["open"]),L(yt,{"available-firmware":_(a),open:_(O).open,onClose:s[14]||(s[14]=e=>_(O).open=!1)},null,8,["available-firmware","open"])],64))}};window.ace=W;const ra=H(oa);ra.use(V),ra.mount("#app");
